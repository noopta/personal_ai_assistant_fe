Let me first check the current state and then give you the complete frontend code.

  Bash(redis-cli LRANGE "activity:4d6deac3-b1a7-4b6e-9f8a-63f66c6fa81a" 0 -1)
  âŽ¿  {                                                                       
       "userIDHash": "4d6deac3-b1a7-4b6e-9f8a-63f66c6fa81a",
       "summary": "Sent email to anuptaislam33@gmail.com | Hello Test Email",
     â€¦ +35 lines (ctrl+r to expand)

â— Perfect! I can see the latest email activity was recorded. Here's exactly what your frontend needs
  to do:

  Frontend Implementation Guide

  1. Recent Activities (One-time fetch)

  // Fetch recent activities for a user
  async function fetchRecentActivities(userIDHash: string, limit: number = 20) {
    try {
      const response = await fetch(`https://api.airthreads.ai/api/activity/recent?limit=${limit}`, {
        method: 'GET',
        credentials: 'include', // Important: includes cookies
        headers: {
          'Content-Type': 'application/json',
        },
        // Alternative if cookies aren't working - pass userIDHash in request body:
        // body: JSON.stringify({ userIDHash })
      });

      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }

      const data = await response.json();
      return data.activities; // Array of activity objects
    } catch (error) {
      console.error('Failed to fetch activities:', error);
      return [];
    }
  }

  // Usage
  const activities = await fetchRecentActivities('4d6deac3-b1a7-4b6e-9f8a-63f66c6fa81a');
  console.log('Recent activities:', activities);

  2. Real-time Activity Stream (SSE)

  // Set up real-time activity stream
  function setupActivityStream(userIDHash: string, onActivity: (activity: any) => void) {
    // Close any existing connection
    if (window.activityStream) {
      window.activityStream.close();
    }

    const eventSource = new
  EventSource(`https://api.airthreads.ai/api/activity/stream?userIDHash=${userIDHash}`, {
      withCredentials: true // Important: includes cookies
    });

    eventSource.onmessage = (event) => {
      try {
        const activity = JSON.parse(event.data);
        onActivity(activity);
      } catch (error) {
        console.error('Failed to parse activity data:', error);
      }
    };

    eventSource.onerror = (error) => {
      console.error('Activity stream error:', error);
      // Implement retry logic if needed
      setTimeout(() => {
        setupActivityStream(userIDHash, onActivity);
      }, 5000);
    };

    eventSource.onopen = () => {
      console.log('Activity stream connected');
    };

    // Store reference for cleanup
    window.activityStream = eventSource;

    return eventSource;
  }

  // Usage
  setupActivityStream('4d6deac3-b1a7-4b6e-9f8a-63f66c6fa81a', (activity) => {
    console.log('New activity:', activity);
    // Update your UI here
    addActivityToUI(activity);
  });

  3. React Hook Implementation

  import { useState, useEffect, useCallback } from 'react';

  interface Activity {
    userIDHash: string;
    summary: string;
    type: string;
    source: string;
    timestamp: number;
    metadata: Record<string, any>;
  }

  export function useActivityStream(userIDHash: string) {
    const [activities, setActivities] = useState<Activity[]>([]);
    const [isConnected, setIsConnected] = useState(false);
    const [error, setError] = useState<string | null>(null);

    // Fetch initial activities
    const fetchInitialActivities = useCallback(async () => {
      try {
        const response = await fetch(`https://api.airthreads.ai/api/activity/recent?limit=50`, {
          credentials: 'include',
          headers: { 'Content-Type': 'application/json' },
        });

        if (response.ok) {
          const data = await response.json();
          setActivities(data.activities || []);
        }
      } catch (err) {
        console.error('Failed to fetch initial activities:', err);
      }
    }, []);

    // Set up SSE stream
    useEffect(() => {
      if (!userIDHash) return;

      fetchInitialActivities();

      const eventSource = new EventSource(
        `https://api.airthreads.ai/api/activity/stream?userIDHash=${userIDHash}`,
        { withCredentials: true }
      );

      eventSource.onopen = () => {
        setIsConnected(true);
        setError(null);
      };

      eventSource.onmessage = (event) => {
        try {
          const activity = JSON.parse(event.data);
          setActivities(prev => [activity, ...prev].slice(0, 100)); // Keep last 100
        } catch (err) {
          console.error('Failed to parse activity:', err);
        }
      };

      eventSource.onerror = () => {
        setIsConnected(false);
        setError('Connection lost. Retrying...');
      };

      return () => {
        eventSource.close();
        setIsConnected(false);
      };
    }, [userIDHash, fetchInitialActivities]);

    return { activities, isConnected, error };
  }

  // Usage in React component
  function ActivityFeed() {
    const userIDHash = '4d6deac3-b1a7-4b6e-9f8a-63f66c6fa81a'; // Get from your auth context
    const { activities, isConnected, error } = useActivityStream(userIDHash);

    return (
      <div>
        <div>Status: {isConnected ? 'ðŸŸ¢ Connected' : 'ðŸ”´ Disconnected'}</div>
        {error && <div>Error: {error}</div>}

        <div>
          {activities.map((activity, index) => (
            <div key={index} className="activity-item">
              <div>{activity.summary}</div>
              <div>Source: {activity.source}</div>
              <div>Time: {new Date(activity.timestamp * 1000).toLocaleString()}</div>
            </div>
          ))}
        </div>
      </div>
    );
  }

  4. Authentication Requirements

  The frontend needs to pass the user authentication. You have two options:

  Option A: Using Cookies (Recommended)
  // Make sure your frontend sets the userIDHash cookie
  document.cookie = `userIDHash=${userIDHash}; path=/; SameSite=Lax`;

  Option B: Using Request Body/Headers
  // For recent activities
  const response = await fetch('https://api.airthreads.ai/api/activity/recent', {
    method: 'POST', // Change to POST if using body
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ userIDHash })
  });

  // For stream (pass in URL params)
  const eventSource = new
  EventSource(`https://api.airthreads.ai/api/activity/stream?userIDHash=${userIDHash}`);

  5. Activity Types You'll Receive

  // Gmail activities
  {
    "type": "gmail.send",
    "source": "gmail",
    "summary": "Sent email to user@example.com | Subject Line",
    "metadata": {
      "subject": "Subject Line",
      "to": ["user@example.com"],
      "messageId": "19a905ec00b43472",
      "threadId": "19a905ec00b43472"
    }
  }

  // Calendar activities (when implemented)
  {
    "type": "calendar.create",
    "source": "calendar",
    "summary": "Created event: Meeting with team",
    "metadata": {
      "eventId": "event_123",
      "summary": "Meeting with team",
      "start": "2025-11-17T15:00:00Z"
    }
  }

  6. Test the Implementation

  First, test with curl to make sure the backend is working:

  # Test recent activities
  curl -H "Cookie: userIDHash=4d6deac3-b1a7-4b6e-9f8a-63f66c6fa81a" \
    https://api.airthreads.ai/api/activity/recent

  # Test stream (will show heartbeat messages)
  curl -H "Cookie: userIDHash=4d6deac3-b1a7-4b6e-9f8a-63f66c6fa81a" \
    https://api.airthreads.ai/api/activity/stream

  The key things your frontend needs:
  1. Set the userIDHash cookie properly
  2. Use credentials: 'include' for fetch requests
  3. Use withCredentials: true for EventSource
  4. Handle the JSON data from the stream events
  5. Implement reconnection logic for dropped connections

  Try this implementation and let me know what specific errors or issues you encounter!